# [section03]【VPC】ネットワークを構築しよう

## AWS のネットワーク概念

- リージョン  
  AWS の各サービスが提供されている地域のこと  
  リージョンによって提供サービスが異なる
- アベイラビリティゾーン  
  独立したデータセンター群のこと  
  各リージョン複数の独立したデータセンターが存在する
- VPC  
  AWS 上に仮想ネットワークを作成することができるサービス  
  VPC はリージョンをまたいで作成することは出来ないが、アベイラビリティゾーンをまたいでの作成は可能
  - サブネット  
    VPC を細かく区切ったネットワーク空間  
    例）パブリックサブネット（web サーバー）やプライベートサブネット（DB サーバー）

リージョン＞アベイラビリティゾーン＞ VPC ＞サブネット

## ネットワークの IP アドレスを決める

- IP アドレスとは  
   ネットワーク上の機器を識別するためのインターネット上の住所
  - 特徴
    - ネットワーク上で重複しない番号
    - 32 ビットの整数値で構成
    - 読みにくいので IP アドレスを 8 ビットずつの 4 つの組に分け.（ピリオド）を入れて 10 進数で表現している
    - 0.0.0.0~255.255.255.255 まで
  - ビット、バイト、2 進数、10 進数
    - 2 進数  
       各行を 0 か 1 を使って数値を表す
    - ビット  
       2 進数の 1 桁（0 か 1）コンピュータのデータ最小単位
    - バイト  
       8 ビットを 1 バイトと呼ぶ。1 バイト＝ 8 ビット
    - 10 進数  
       １０種類の数値（0~9）を使い数値を表す。
  - パプリック IP アドレス
    - インターネットに接続する際に使用する IP アドレスのこと
    - ICANN という団体が重複しないよう管理を行う
    - プロバイダー、サーバー事業者から付与（貸し出し）される
  - プライベート IP アドレス
    - インターネットで使用されない IP アドレス
    - 範囲内のアドレスであれば自由に使用することができる
    - 社内 LAN などの構築やネットワーク実験時に用いる（インターネットに接続する必要がないとき）
  - IP アドレスの範囲を表記  
     ネットワーク構築する際には、そのネットワークで利用する IP アドレスの範囲を決める必要がある。  
     IP アドレスはネットワーク部とホスト部に区分けすることで、範囲を表記する。  
     例）192.168.128.0~192.168.128.255 の範囲を指定したとすると前半の固定部分（値が変わらない部分）のことをネットワーク部、後半の可変部分（値が変わる部分）のことをホスト部と呼ぶ。
  - IP アドレス範囲の表記法
    1. CIDR 表記  
       IP アドレスの後ろに「/」を書き、その後ろにネットワーク部が先頭から何ビット目までなのかを記載する。
    2. サブネットマスク表記  
       IP アドレスの後ろに「/」を書き、ネットワーク部を表すビットと同じ部分を１に、ホスト部を表すビットと同じ部分を０にする。

## VPC の作成

- 作成手順
  1. VPC 作成
     リージョンを「東京」に変更
     AWS マネジメントコンソール＞ VPC ＞ VPC ＞ VPC の作成
     名前タグ、IPv4 CIDR ブロック、IPv6 CIDR ブロック、テナンシーそれぞれ入力して「VPC の作成」を選択
     VPC の一覧に作成した VPC が表示されていることを確認
  2. サブネット作成
     - パブリックサブネットを作成
     - プライベートサブネットを作成  
       AWS マネジメントコンソール＞ VPC ＞サブネット＞サブネットの作成  
       名前タグ、VPC、アベイラビリティゾーン、IPv4 CIDR ブロックそれぞれ入力して「作成」を選択  
       サブネットの一覧に作成したサブネットが表示されていることを確認
  3. ルーティングを設定する
     パブリックサブネットからインターネットに接続できるようにする
     - ルーティングとは  
       インターネットはルーターが IP アドレスの行き先を管理しているので、ネットワークとネットワークが IP アドレスを通じて接続することができる。  
       これをルーティングという。
     - ルートテーブルとは
       宛先の IP アドレスと次のルーター（ターゲット）という書式で設定  
       ルートテーブルに登録されているどのアドレスにも一致しない場合の経路のことを「デフォルトルート」と言う。  
       各サブネットに対してルートテーブルを設定することができる  
       サブネットやインターネットゲートウェイ間にはルーターが動いている
     - インターネットゲートウェイとは  
        VPC とインターネットを繋ぐ仮想ルーターのこと
     - インターネットゲートウェイを作成し、VPC にアタッチする
     - ルートテーブルを作成し、パブリックサブネットに紐付け
